// MIT license-castrato - Â©2014 Pehr Boman <github.com/unkelpehr>
(function(f,g){"function"===typeof define&&define.amd?define([],g):"object"===typeof exports?module.exports=g():f.castrato=g})(this,function(){function f(g,a,d,b,c){var e=c||h[a]||[],f=e.length,l=f,p=f,m=[],q;if(p)for(q=b?function(a){a&&m.push(a);--l||(b(m,f),b=0)}:r;c=e[--p];)c[1](d,1<c[2]?q:l--);!l&&b&&b(m,f);g&&(k[a]||(k[a]=[])).push([d,b])}var g=0,h={},k={},r=function(){};return function(){var n=g++;return{emit:function(a,d,b,c){!0!==a&&!1!==a&&(c=b,b=d,d=a,a=!1);f(a,d,b,c);return this},on:function(a,
d){var b,c,e=[n,d,d.length];(h[a]||(h[a]=[])).push(e);if(k[a])for(b=0,e=[e];c=k[a][b++];)f(0,0,c[0],c[1],e);return this},off:function(a,d){var b,c=0,e=h[a];if(e)for(;b=e[c++];)b[0]!==n||d&&d!==b[1]||e.splice(--c,1);return this}}}}());