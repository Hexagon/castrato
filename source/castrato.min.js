// Licenced under MIT - castrato - Â©2014 Pehr Boman <github.com/unkelpehr>
(function(f,g){"function"===typeof define&&define.amd?define([],g()):"object"===typeof exports?module.exports=g:f.castrato=g})(this,function(){function f(e,a,b,c){var d=[e,b,1<b.length];(h[a]||(h[a]=[])).push(d);if(k[a])for(e=0,d=[d];(b=k[a][e++])&&(l(0,0,b[0],b[1],d),!c););}function g(e,a,b){var c=0;if(toSubs=h[a])for(;a=toSubs[c++];)a[0]!==e||b&&b!==a[1]||toSubs.splice(--c,1)}function l(e,a,b,c,d){var g=d||h[a]||[],n,f,l,p=[],m;h["*"]&&(g=g.concat(h["*"]));if(l=f=n=g.length)for(m=c?function(a){a&&
p.push(a);--f||(c(p,n),c=0)}:q;d=g[--l];)d[1](b,d[2]?m:f--,a);!f&&c&&c(p,n);e&&(k[a]||(k[a]=[])).push([b,c])}var m=0,h={},k={},q=function(){};return function(){var e=m++;return{emit:function(a,b,c,d){!0!==a&&!1!==a&&(d=c,c=b,b=a,a=!1);l(a,b,c,d);return this},on:function(a,b){f(e,a,b);return this},once:function(a,b){f(e,a,function d(f,h){g(e,a,d);b(f,1<b.length?h:h())},!0);return this},off:function(a,b){g(e,a,b);return this},destroy:function(){m=e=0;h={};k={};return this}}}}());