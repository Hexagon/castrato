// Licenced under MIT - castrato - Â©2014 Pehr Boman <github.com/unkelpehr>
(function(e,g){"function"===typeof define&&define.amd?define([],g()):"object"===typeof exports?module.exports=g:e.castrato=g})(this,function(){function e(f,a,b,c){var d=[f,b,b.length];(h[a]||(h[a]=[])).push(d);if(k[a])for(f=0,d=[d];(b=k[a][f++])&&(l(0,0,b[0],b[1],d),!c););}function g(f,a,b){var c=0;if(toSubs=h[a])for(;a=toSubs[c++];)a[0]!==f||b&&b!==a[1]||toSubs.splice(--c,1)}function l(f,a,b,c,d){var g=d||h[a]||[],e=g.length,n=e,l=e,p=[],m;if(l)for(m=c?function(a){a&&p.push(a);--n||(c(p,e),c=0)}:
q;d=g[--l];)d[1](b,1<d[2]?m:n--);!n&&c&&c(p,e);f&&(k[a]||(k[a]=[])).push([b,c])}var m=0,h={},k={},q=function(){};return function(){var f=m++;return{emit:function(a,b,c,d){!0!==a&&!1!==a&&(d=c,c=b,b=a,a=!1);l(a,b,c,d);return this},on:function(a,b){e(f,a,b);return this},once:function(a,b){var c=function(d,e){g(f,a,c);b(d,1<b.length?e:e())};e(f,a,c,!0);return this},off:function(a,b){g(f,a,b);return this},destroy:function(){m=0;h={};k={}}}}}());